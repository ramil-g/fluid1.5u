var fluid_1_5=fluid_1_5||{};(function($,fluid){fluid.registerNamespace("fluid.dom");fluid.dom.getDocumentHeight=function(dokkument){var body=$("body",dokkument)[0];return body.offsetHeight};fluid.defaults("fluid.uiOptions.fatPanel",{gradeNames:["fluid.uiOptions.inline","autoInit"],events:{afterRender:null,onReady:null},listeners:{onReady:{listener:"fluid.uiOptions.fatPanel.bindEvents",args:["{fatPanel}.uiOptionsLoader.uiOptions","{iframeRenderer}.iframeEnhancer","{fatPanel}"]}},selectors:{reset:".flc-uiOptions-reset",iframe:".flc-uiOptions-iframe"},invokers:{bindReset:{funcName:"fluid.bind",args:["{fatPanel}.dom.reset","click","{arguments}.0"]}},components:{pageEnhancer:"{uiEnhancer}",slidingPanel:{type:"fluid.slidingPanel",container:"{fatPanel}.container",options:{invokers:{operateShow:{funcName:"fluid.uiOptions.fatPanel.showPanel"},operateHide:{funcName:"fluid.uiOptions.fatPanel.hidePanel"}}},createOnEvent:"afterRender"},iframeRenderer:{type:"fluid.uiOptions.fatPanel.renderIframe",container:"{fatPanel}.dom.iframe",options:{markupProps:{src:"%prefix/FatPanelUIOptionsFrame.html"},events:{afterRender:"{fatPanel}.events.afterRender"},components:{iframeEnhancer:{type:"fluid.uiEnhancer",container:"{iframeRenderer}.renderUIOContainer",createOnEvent:"afterRender",options:{gradeNames:["fluid.uiEnhancer.starterEnactors"],jQuery:"{iframeRenderer}.jQuery",tocTemplate:"{pageEnhancer}.options.tocTemplate",events:{onIframeVisible:null}}}}}},uiOptionsLoader:{type:"fluid.uiOptions.fatPanelLoader"}},outerEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",distributeOptions:[{source:"{that}.options.slidingPanel.options",removeSource:true,target:"{that > slidingPanel}.options"},{source:"{that}.options.iframeRenderer.options",removeSource:true,target:"{that > iframeRenderer}.options"},{source:"{that}.options.iframe",removeSource:true,target:"{that}.options.selectors.iframe"},{source:"{that}.options.outerEnhancerOptions",removeSource:true,target:"{that iframeEnhancer}.options"},{source:"{that}.options.prefix",target:"{that > iframeRenderer}.options.prefix"}]});fluid.defaults("fluid.uiOptions.fatPanel.renderIframe",{gradeNames:["fluid.viewComponent","autoInit"],events:{afterRender:null},styles:{containerFlex:"fl-container-flex",container:"fl-uiOptions-fatPanel-iframe"},prefix:"./",markupProps:{"class":"flc-iframe",src:"%prefix/uiOptionsIframe.html"}});fluid.uiOptions.fatPanel.renderIframe.finalInit=function(that){var styles=that.options.styles;that.options.markupProps.src=fluid.stringTemplate(that.options.markupProps.src,{"prefix/":that.options.prefix});that.iframeSrc=that.options.markupProps.src;that.iframe=$("<iframe/>");that.iframe.load(function(){var iframeWindow=that.iframe[0].contentWindow;that.iframeDocument=iframeWindow.document;that.jQuery=iframeWindow.jQuery;that.renderUIOContainer=that.jQuery("body",that.iframeDocument);that.jQuery(that.iframeDocument).ready(that.events.afterRender.fire)});that.iframe.attr(that.options.markupProps);that.iframe.addClass(styles.containerFlex);that.iframe.addClass(styles.container);that.iframe.hide();that.iframe.appendTo(that.container)};fluid.uiOptions.fatPanel.updateView=function(uiOptions){uiOptions.events.onUIOptionsRefresh.fire();uiOptions.events.onSignificantDOMChange.fire()};fluid.uiOptions.fatPanel.bindEvents=function(uiOptions,iframeEnhancer,fatPanel){fatPanel.slidingPanel.events.afterPanelShow.addListener(function(){iframeEnhancer.events.onIframeVisible.fire(iframeEnhancer);fluid.uiOptions.fatPanel.updateView(uiOptions)});uiOptions.events.onUIOptionsRefresh.addListener(function(){iframeEnhancer.updateModel(uiOptions.model.selections)});uiOptions.events.onReset.addListener(function(uiOptions){fluid.uiOptions.fatPanel.updateView(uiOptions)});uiOptions.events.onSignificantDOMChange.addListener(function(){var dokkument=uiOptions.container[0].ownerDocument;var height=fluid.dom.getDocumentHeight(dokkument);var iframe=fatPanel.iframeRenderer.iframe;var attrs={height:height+15};var panel=fatPanel.slidingPanel.locate("panel");panel.css({height:""});iframe.animate(attrs,400)});iframeEnhancer.events.onIframeVisible.addListener(function(){iframeEnhancer.textSize.set(iframeEnhancer.model.textSize);iframeEnhancer.lineSpace.set(iframeEnhancer.model.lineSpace)});fatPanel.slidingPanel.events.afterPanelHide.addListener(function(){fatPanel.iframeRenderer.iframe.height(0);fatPanel.iframeRenderer.iframe.hide()});fatPanel.slidingPanel.events.onPanelShow.addListener(function(){fatPanel.iframeRenderer.iframe.show()})};fluid.uiOptions.fatPanel.hidePanel=function(panel,callback){$(panel).animate({height:0},{duration:400,complete:callback})};fluid.uiOptions.fatPanel.showPanel=function(panel,callback){setTimeout(callback,1)};fluid.defaults("fluid.uiOptions.fatPanelLoader",{gradeNames:["fluid.uiOptions.loader","autoInit"],components:{uiOptions:{createOnEvent:"templatesAndIframeReady",container:"{iframeRenderer}.renderUIOContainer",options:{gradeNames:["fluid.uiOptions.uiEnhancerRelay"],model:"{fatPanel}.model",applier:"{fatPanel}.applier",events:{onSignificantDOMChange:null,updateEnhancerModel:"{that}.events.modelChanged"},listeners:{modelChanged:"{that}.save",onCreate:{listener:"{fatPanel}.bindReset",args:["{that}.reset"]}},components:{iframeRenderer:"{fatPanel}.iframeRenderer"}}}},events:{templatesAndIframeReady:{events:{iframeReady:"{fatPanel}.events.afterRender",templateReady:"onUIOptionsTemplateReady"}},onReady:"{fatPanel}.events.onReady"}})})(jQuery,fluid_1_5);